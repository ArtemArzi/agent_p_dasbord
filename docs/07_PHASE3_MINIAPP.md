# Phase 3: Mini App (Deferred)

> [!IMPORTANT]
> –≠—Ç–∞ —Ñ–∞–∑–∞ **–æ—Ç–ª–æ–∂–µ–Ω–∞**. –°–Ω–∞—á–∞–ª–∞ –∑–∞–≤–µ—Ä—à–∞–µ–º Phase 1 –∏ Phase 2.

## –û–±–∑–æ—Ä

**–°—Ä–æ–∫:** 2-3 –º–µ—Å—è—Ü–∞ (–ø–æ—Å–ª–µ Phase 2)  
**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** React + Telegram Web App SDK  
**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –ö–ª–∏–µ–Ω—Ç—ã —Å–∞–ª–æ–Ω–∞ (–Ω–µ –∞–¥–º–∏–Ω—ã)

---

## –ü–æ—á–µ–º—É Mini App?

| –ü—Ä–æ–±–ª–µ–º–∞ —á–∞—Ç-–±–æ—Ç–∞ | –†–µ—à–µ–Ω–∏–µ Mini App |
|-------------------|------------------|
| –í—ã–±–æ—Ä –¥–∞—Ç—ã –∫–Ω–æ–ø–∫–∞–º–∏ –Ω–µ—É–¥–æ–±–µ–Ω | –í–∏–∑—É–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å |
| –ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø–∏—Å–µ–π –Ω–µ –≤–∏–¥–Ω–∞ | –ì–∞–ª–µ—Ä–µ—è –∑–∞–ø–∏—Å–µ–π |
| –ù–µ—Ç "—Å–≤–æ–µ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞" | –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç |
| –õ–æ—è–ª—å–Ω–æ—Å—Ç—å —Å–ª–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å | –ë–∞–ª–ª—ã –∏ –±–æ–Ω—É—Å—ã |

---

## Scope Mini App v1

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üì± MINI APP v1 SCOPE                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚úÖ Visual Calendar Picker              ‚îÇ
‚îÇ  ‚úÖ Client Profile Dashboard            ‚îÇ
‚îÇ  ‚úÖ Booking History Gallery             ‚îÇ
‚îÇ  ‚úÖ Loyalty Points Display              ‚îÇ
‚îÇ  ‚ùå Complex AI flows (defer to v2)      ‚îÇ
‚îÇ  ‚ùå Payments (use Telegram native)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Telegram Mini App                        ‚îÇ
‚îÇ                    (React + TG SDK)                         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                           ‚Üì                                 ‚îÇ
‚îÇ                    Dashboard API                            ‚îÇ
‚îÇ                    (FastAPI endpoints)                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                           ‚Üì                                 ‚îÇ
‚îÇ                      Supabase                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ó–∞—á–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π API?

Mini App —Ç—Ä–µ–±—É–µ—Ç REST API –¥–ª—è:
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram initData
- –ü–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å API endpoints –≤ Dashboard (FastAPI).

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| **Frontend** | React 18+ |
| **Styling** | Tailwind CSS |
| **State** | Zustand / React Query |
| **TG SDK** | @telegram-apps/sdk |
| **Calendar** | react-calendar |
| **API Client** | Axios |
| **Build** | Vite |

---

## –°—Ç—Ä–∞–Ω–∏—Ü—ã Mini App

### 1. Home (Profile)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     üë§ –ú–∞—Ä–∏—è        ‚îÇ
‚îÇ  +7 999 123-45-67   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üèÜ –ë–∞–ª–ª—ã: 1,250     ‚îÇ
‚îÇ üìÖ –ó–∞–ø–∏—Å–µ–π: 12      ‚îÇ
‚îÇ ‚ù§Ô∏è –ú–∞—Å—Ç–µ—Ä: –ê–Ω–Ω–∞     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [üìÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è]     ‚îÇ
‚îÇ [üìã –ú–æ–∏ –∑–∞–ø–∏—Å–∏]     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2. Calendar

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     –î–µ–∫–∞–±—Ä—å 2025    ‚îÇ
‚îÇ –ü–Ω –í—Ç –°—Ä –ß—Ç –ü—Ç –°–± –í—Å‚îÇ
‚îÇ  1  2  3  4  5  6  7‚îÇ
‚îÇ  8  9 10 11 12 13 14‚îÇ
‚îÇ 15 16 17 18 19[20]21‚îÇ
‚îÇ 22 23 24 25 26 27 28‚îÇ
‚îÇ 29 30 31            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è:     ‚îÇ
‚îÇ [10:00] [11:00] ... ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3. Booking History

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìã –ú–æ–∏ –∑–∞–ø–∏—Å–∏       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 15 –¥–µ–∫ ‚Ä¢ –ú–∞–Ω–∏–∫—é—Ä    ‚îÇ
‚îÇ –ú–∞—Å—Ç–µ—Ä: –ê–Ω–Ω–∞        ‚îÇ
‚îÇ ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 25 –¥–µ–∫ ‚Ä¢ –ü–µ–¥–∏–∫—é—Ä    ‚îÇ
‚îÇ –ú–∞—Å—Ç–µ—Ä: –ê–Ω–Ω–∞        ‚îÇ
‚îÇ üïê –û–∂–∏–¥–∞–µ—Ç—Å—è        ‚îÇ
‚îÇ [–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏][–û—Ç–º–µ–Ω–∏—Ç—å]
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## API Endpoints (Dashboard)

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```python
from fastapi import APIRouter, Header, HTTPException
from telegram import validate_init_data

router = APIRouter(prefix="/api/miniapp")

@router.get("/me")
async def get_current_user(
    x_telegram_init_data: str = Header(...)
):
    """–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram initData
    if not validate_init_data(x_telegram_init_data):
        raise HTTPException(401, "Invalid initData")
    
    user_data = parse_init_data(x_telegram_init_data)
    telegram_id = user_data["user"]["id"]
    
    # –ù–∞–π—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞
    client = await get_client_by_telegram_id(telegram_id)
    if not client:
        raise HTTPException(404, "Client not found")
    
    return client
```

### –ó–∞–ø–∏—Å–∏

```python
@router.get("/bookings")
async def get_my_bookings(telegram_id: int):
    """–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–∞"""
    # ...

@router.post("/bookings")
async def create_booking(booking: BookingCreate, telegram_id: int):
    """–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å"""
    # –í—ã–∑–≤–∞—Ç—å YClients API
    # ...

@router.delete("/bookings/{booking_id}")
async def cancel_booking(booking_id: str, telegram_id: int):
    """–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å"""
    # ...
```

### –°–ª–æ—Ç—ã

```python
@router.get("/slots")
async def get_available_slots(
    date: str,
    service_id: str,
    staff_id: str | None = None
):
    """–ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã"""
    # –ó–∞–ø—Ä–æ—Å –∫ YClients API
    # ...
```

---

## Telegram Web App SDK

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```typescript
// src/main.tsx
import { init, postEvent } from '@telegram-apps/sdk';

init();

// Expand to full screen
postEvent('web_app_expand');

// Get init data for auth
const initData = window.Telegram.WebApp.initData;
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```typescript
// src/components/BackButton.tsx
import { useEffect } from 'react';
import { postEvent } from '@telegram-apps/sdk';

export function useBackButton(onClick: () => void) {
  useEffect(() => {
    postEvent('web_app_setup_back_button', { is_visible: true });
    
    window.Telegram.WebApp.onEvent('backButtonClicked', onClick);
    
    return () => {
      postEvent('web_app_setup_back_button', { is_visible: false });
    };
  }, [onClick]);
}
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Dashboard

Mini App –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–∑ –±–æ—Ç–∞:

```python
# –í Agent P Bot
from aiogram.types import WebAppInfo, InlineKeyboardButton

button = InlineKeyboardButton(
    text="üì± –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",
    web_app=WebAppInfo(url="https://app.example.com")
)
```

Dashboard –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è Mini App.

---

## –ü–æ—á–µ–º—É –ù–ï —Å–µ–π—á–∞—Å?

| –ü—Ä–∏—á–∏–Ω–∞ | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|---------|------------|
| **–§–æ–∫—É—Å** | Dashboard MVP –≤–∞–∂–Ω–µ–µ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ |
| **–î–∞–Ω–Ω—ã–µ** | –ù—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ —Å–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (Profile Builder) |
| **–†–µ—Å—É—Ä—Å—ã** | React —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã |
| **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç** | –ö–ª–∏–µ–Ω—Ç—ã —É–∂–µ –º–æ–≥—É—Ç –∑–∞–ø–∏—Å–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞ |

---

## Pre-requisites –¥–ª—è Phase 3

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º Phase 3 –Ω—É–∂–Ω–æ:

- [x] Phase 1: Dashboard MVP
- [ ] Phase 2: Clients + Settings
- [ ] Profile Builder (Feature #5 –∏–∑ PRODUCT_STRATEGY)
- [ ] API endpoints –≤ Dashboard
- [ ] Telegram Bot –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è Mini App

---

## Mini App v2 (–ë—É–¥—É—â–µ–µ)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ v1:

| –§–∏—á–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| **CopilotKit** | Generative UI –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ |
| **AI Suggestions** | "–í–∞–º –ø–æ–Ω—Ä–∞–≤–∏—Ç—Å—è..." |
| **Payments** | Telegram Payments –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è |
| **Push Notifications** | –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö |

---

## –°—Å—ã–ª–∫–∏

- [Telegram Mini Apps Docs](https://core.telegram.org/bots/webapps)
- [@telegram-apps/sdk](https://docs.telegram-mini-apps.com/)
- [06_PHASE2_FEATURES.md](./06_PHASE2_FEATURES.md) ‚Äî –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Ñ–∞–∑–∞
